# FER2013 Synthetic Data Recognition Project

This is a group project for **COMP4026/COMP7055 - Computer Vision**, Spring 2024-2025.  
Our objective is to evaluate how well facial expression recognition models can be trained using **synthetic data** generated by StyleGAN2-ADA, compared with real-world data (FER2013).

---

## 🔍 Objective

This project investigates the following:

- Can facial expression models be effectively trained using synthetic data?
- How does performance vary with different real/synthetic data ratios?
- How do different model architectures respond to synthetic data?

---

## 🧱 Dataset: FER2013

- ~35,000 grayscale images (48x48), 7 emotion categories
- Download: [FER2013 on Kaggle](https://www.kaggle.com/datasets/msambare/fer2013)
- Converted to RGB 224x224 for compatibility with pretrained CNNs

---

## 🧠 Method Overview

1. **GAN-based Synthetic Generation**:  
   We use pretrained StyleGAN2-ADA models to synthesize expression images.
2. **Real/Synthetic Mixing**:  
   The training data is mixed at configurable rates: `[0.0, 0.1, 0.3, 0.5, 1.0]`
3. **Model Zoo**:  
   We test with 7 CNN architectures.
4. **Training Pipeline**:  
   Uses PyTorch Lightning + DataModule abstraction
5. **Evaluation**:  
   Metrics include Accuracy, AUROC, F1 Score, Precision, Recall.

---

## 🧪 Models Compared

| Model | Type | Params | Speed | Notes |
|-------|------|--------|-------|-------|
| ResNet18 | Baseline | 11M | Fast | Good starting point |
| ResNet50 | Deeper CNN | 23M | Medium | Better accuracy |
| EfficientNetB0 | Auto-optimized | 5M | Fast | Efficient & effective |
| MobileNetV3 | Lightweight | 5.4M | Very Fast | Mobile-friendly |
| ShuffleNetV2 | Ultra-light | 1.3M | 🔥 Super Fast | For edge devices |
| DenseNet121 | Feature reuse | 8M | Medium | Deep feature flow |
| ConvNeXt-Tiny | Modern CNN | 28M | Medium | Inspired by transformers |

---

## 🗂 Project Structure

```
src/
├── main.py              # CLI entrypoint
├── train.py             # run_experiments(), plots
├── data.py              # FER2013 + synthetic dataloader
├── models.py            # All CNN architectures
├── load_stylegan.py     # Lightweight G_ema loader
├── platform.yaml        # Local vs Kaggle GAN path switch
├── checkpoints/         # Best models by val_f1
└── results/             # Metrics summary (YAML + plots)
```

---

## ⚙️ How to Run

### 🔁 Local (Mac / PC)

```bash
python main.py
```

### 🧪 On Kaggle

```bash
python main.py --platform kaggle
```

Set your `.pkl` paths in `platform.yaml` accordingly.

---

## 📊 Evaluation Metrics

- Accuracy ✅
- F1 Score ✅
- AUROC ✅
- Precision ✅
- Recall ✅
- Confusion Matrix ✅

---

## 🎓 Course Requirements Mapping

| Task | How We Did It |
|------|----------------|
| Generate synthetic data | StyleGAN2-ADA pretrained G_ema |
| Train with real FER2013 | DataModule + CSVLoader |
| Train with synthetic data | Mixed with ratio control |
| Compare results | Console + YAML + matplotlib |
| Evaluate with metrics | sklearn + torchmetrics |
| Report insights | via visualizations and logs |

---

## 📅 Milestone Schedule

- ✅ Proposal submitted
- ✅ Synthetic + real data processing
- ✅ Model experiments & analysis
- ⏳ Final report due: **28 April 2025**

---

## 📜 License

This project is for academic use only (HKBU COMP4026/7055 coursework).
